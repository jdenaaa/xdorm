(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a3329"],{"00c6":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"crumbs"},[o("el-breadcrumb",{attrs:{separator:"/"}},[o("el-breadcrumb-item",[o("i",{staticClass:"el-icon-lx-calendar"}),t._v(" 学生管理")]),o("el-breadcrumb-item",[t._v("分配宿舍")])],1)],1),o("div",{staticClass:"container"},[o("el-button",{attrs:{type:"primary"},on:{click:t.onBack}},[t._v("返回")]),o("div",{staticClass:"form-box"},[t._m(0),o("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"姓名："}},[o("el-tag",{model:{value:t.oldStudent.name,callback:function(e){t.$set(t.oldStudent,"name",e)},expression:"oldStudent.name"}},[t._v(t._s(t.oldStudent.name))]),t._v("  学号：\n        "),o("el-tag",{model:{value:t.oldStudent.stuId,callback:function(e){t.$set(t.oldStudent,"stuId",e)},expression:"oldStudent.stuId"}},[t._v(t._s(t.oldStudent.stuId))]),t._v("   性别：\n         "),o("el-tag",{model:{value:t.oldStudent.gender,callback:function(e){t.$set(t.oldStudent,"gender",e)},expression:"oldStudent.gender"}},[t._v(t._s(t.oldStudent.gender))]),t._v("  当前所在宿舍：\n         "),o("el-tag",[t._v(t._s(t.oldStudent.roomName))])],1),o("el-form-item",{attrs:{label:"学院："}},[o("el-tag",{model:{value:t.oldStudent.collegeName,callback:function(e){t.$set(t.oldStudent,"collegeName",e)},expression:"oldStudent.collegeName"}},[t._v(t._s(t.oldStudent.collegeName))]),t._v(" 专业：\n         "),o("el-tag",{model:{value:t.oldStudent.majorName,callback:function(e){t.$set(t.oldStudent,"majorName",e)},expression:"oldStudent.majorName"}},[t._v(t._s(t.oldStudent.majorName))]),t._v(" 班别：\n         "),o("el-tag",{model:{value:t.oldStudent.className,callback:function(e){t.$set(t.oldStudent,"className",e)},expression:"oldStudent.className"}},[t._v(t._s(t.oldStudent.className))])],1),o("div",[o("h2",[t._v("重新分配宿舍")])]),o("el-form-item",{attrs:{label:"分配公寓"}},[o("el-radio-group",{attrs:{"label-in-value":!0},on:{change:t.getDormFloorByDormId},model:{value:t.dormId,callback:function(e){t.dormId=e},expression:"dormId"}},t._l(t.dormList,function(e,a){return o("el-radio",{key:a,staticStyle:{width:"180px"},attrs:{label:e.dormId,value:e.dormName,border:""}},[t._v(t._s(e.dormName))])}),1)],1),o("el-form-item",{attrs:{label:"楼层·房间"}},[o("el-col",{attrs:{span:11}},[o("el-select",{attrs:{placeholder:"选择楼层","label-in-value":!0},on:{change:t.getRoomByfloor},model:{value:t.floorLevel,callback:function(e){t.floorLevel=e},expression:"floorLevel"}},t._l(t.floorList,function(t,e){return o("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),o("el-col",{staticClass:"line",attrs:{span:2}},[t._v("楼")]),o("el-col",{attrs:{span:11}},[o("el-select",{attrs:{placeholder:"选择房间","label-in-value":!0},on:{change:t.getRoomInfoById},model:{value:t.form.roomId,callback:function(e){t.$set(t.form,"roomId",e)},expression:"form.roomId"}},t._l(t.roomList,function(t,e){return o("el-option",{key:e,attrs:{label:t.roomName,value:t.roomId}})}),1)],1)],1),o("div",{staticClass:"plugins-tips"},[o("div",{staticStyle:{color:"red"}},[t._v(t._s(t.roomstatus))]),o("div",[t._v("可住人数："+t._s(t.currentRoom.bedCount))]),o("div",[t._v("已住人数："+t._s(t.currentRoom.memberTotal))])]),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交修改")]),o("el-button",{on:{click:t.onBack}},[t._v("取消返回")])],1)],1)],1)],1)])},s=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("h2",[t._v("学生基本信息")])])}],l=(o("7514"),{name:"baseform",data:function(){return{old_stu_id:"",oldStudent:"",dormList:"",floorList:"",roomList:"",gradeList:"",floorLevel:"",selectRoom:"",dormId:"",currentRoom:"",gradeId:"",roomstatus:"",form:{stuId:"",name:"",collegeName:"",collegeId:"",majorName:"",majorId:"",className:"",classId:"",gender:"",phone:"",roomId:"",roomName:""}}},mounted:function(){this.getInitData()},created:function(t){this.old_stu_id=this.$route.query.stuId},methods:{getInitData:function(){var t=this;this.$axios.get(this.GLOBAL.BASE_URL+"/college/all").then(function(e){t.collegeList=e.data}),this.$axios.get(this.GLOBAL.BASE_URL+"/dorm/all").then(function(e){t.dormList=e.data}),this.$axios.get(this.GLOBAL.BASE_URL+"/grade/all").then(function(e){t.gradeList=e.data}),this.$axios.post(this.GLOBAL.BASE_URL+"/student/getstu",{stuId:this.old_stu_id}).then(function(e){t.oldStudent=e.data}),this.stuId=this.oldStudent.stuId},onSubmit:function(){var t=this;this.$axios.post(this.GLOBAL.BASE_URL+"/student/update",{newStudent:this.oldStudent}).then(function(e){if(200==e.data.status)return t.$message.success("修改房间为："+t.oldStudent.roomName+"成功"),void t.reload();t.$message.error("修改房间失败："+e.data.msg)})},onBack:function(){this.$router.back(-1)},getDormFloorByDormId:function(t){var e=this;this.$message("选中公寓："+t),this.floorList="",this.roomList="",this.form.roomName="",this.currentRoom="",this.dormId=t,this.$axios.get(this.GLOBAL.BASE_URL+"/dorm/dormid/"+t).then(function(t){e.floorList=t.data})},getRoomByfloor:function(t){var e=this;this.$message("选中的楼层："+t),this.roomList="",this.form.roomName="",this.currentRoom="",this.currentRoom="",this.$axios.get(this.GLOBAL.BASE_URL+"/room/"+this.dormId+"/"+t).then(function(t){e.roomList=t.data})},getRoomInfoById:function(t){var e={};if(e=this.roomList.find(function(e){return e.roomId===t}),this.oldStudent.roomName=e.roomName,this.oldStudent.roomId=e.roomId,e.memberTotal>=e.bedCount)return this.roomstatus="该房间已满员，请选择其他房间",this.$message.error("房间"+e.roomName+"已满员，请选择其他房间"),void(this.currentRoom=e);this.roomstatus="",this.currentRoom=e,this.form.roomName=e.roomName}}}),r=l,n=o("2877"),d=Object(n["a"])(r,a,s,!1,null,null,null);e["default"]=d.exports}}]);